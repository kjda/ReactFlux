!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n(require("promise")):"function"==typeof define&&define.amd?define(["promise"],n):"object"==typeof exports?exports.ReactFlux=n(require("promise")):t.ReactFlux=n(t.promise)}(this,function(t){return function(t){function n(r){if(e[r])return e[r].exports;var o=e[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var e={};return n.m=t,n.c=e,n.p="",n(0)}([function(t,n,e){var r=e(26),o=e(29),i=e(43),s=e(1),a=e(47),c=e(28),u=new a;t.exports={configs:c,createActions:function(t){return new o(u,t)},createStore:function(t,n){return new i(u,t,n)},createConstants:function(t,n){return new r(t,n)},dispatch:function(t,n){u.dispatch(t,n)},dispatcher:u,mixin:function(){console.warn("ReactFlux.mixin is deprecated. please use ReactFlux.mixinFor");var t=Array.prototype.slice.call(arguments);s.call(this,t)},mixinFor:s}},function(t,n,e){var r=e(2);t.exports=function(){var t=Array.prototype.slice.call(arguments);if(!t.length)throw new Error("Flux.mixinFor expects a store or a list of stores");return r(t,function(t){var n="undefined"==typeof t||"function"!=typeof t.onChange||"function"!=typeof t.offChange;if(n)throw new Error("Flux.mixinFor expects a store or an array of stores")}),{componentWillMount:function(){"undefined"==typeof this._react_flux_onChange&&(this._react_flux_onChange=function(){this.isMounted()&&this.setState(this.getStateFromStores())}.bind(this)),this.setState(this.getStateFromStores())},componentDidMount:function(){for(var n=0;n<t.length;n++)t[n].onChange(this._react_flux_onChange)},componentWillUnmount:function(){for(var n=0;n<t.length;n++)t[n].offChange(this._react_flux_onChange)}}}},function(t,n,e){var r=e(3),o=e(4),i=e(23),s=i(r,o);t.exports=s},function(t,n,e){function r(t,n){for(var e=-1,r=t.length;++e<r&&n(t[e],e,t)!==!1;);return t}t.exports=r},function(t,n,e){var r=e(5),o=e(22),i=o(r);t.exports=i},function(t,n,e){function r(t,n){return o(t,n,i)}var o=e(6),i=e(10);t.exports=r},function(t,n,e){var r=e(7),o=r();t.exports=o},function(t,n,e){function r(t){return function(n,e,r){for(var i=o(n),s=r(n),a=s.length,c=t?a:-1;t?c--:++c<a;){var u=s[c];if(e(i[u],u,i)===!1)break}return n}}var o=e(8);t.exports=r},function(t,n,e){function r(t){return o(t)?t:Object(t)}var o=e(9);t.exports=r},function(t,n,e){function r(t){var n=typeof t;return"function"==n||!!t&&"object"==n}t.exports=r},function(t,n,e){var r=e(11),o=e(12),i=e(9),s=e(16),a=o(a=Object.keys)&&a,c=a?function(t){if(t)var n=t.constructor,e=t.length;return"function"==typeof n&&n.prototype===t||"function"!=typeof t&&e&&r(e)?s(t):i(t)?a(t):[]}:s;t.exports=c},function(t,n,e){function r(t){return"number"==typeof t&&t>-1&&t%1==0&&o>=t}var o=Math.pow(2,53)-1;t.exports=r},function(t,n,e){function r(t){return null==t?!1:f.call(t)==s?p.test(u.call(t)):i(t)&&a.test(t)}var o=e(13),i=e(15),s="[object Function]",a=/^\[object .+?Constructor\]$/,c=Object.prototype,u=Function.prototype.toString,f=c.toString,p=RegExp("^"+o(f).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=r},function(t,n,e){function r(t){return t=o(t),t&&s.test(t)?t.replace(i,"\\$&"):t}var o=e(14),i=/[.*+?^${}()|[\]\/\\]/g,s=RegExp(i.source);t.exports=r},function(t,n,e){function r(t){return"string"==typeof t?t:null==t?"":t+""}t.exports=r},function(t,n,e){function r(t){return!!t&&"object"==typeof t}t.exports=r},function(t,n,e){function r(t){for(var n=c(t),e=n.length,r=e&&t.length,f=r&&a(r)&&(i(t)||u.nonEnumArgs&&o(t)),l=-1,h=[];++l<e;){var d=n[l];(f&&s(d,r)||p.call(t,d))&&h.push(d)}return h}var o=e(17),i=e(18),s=e(19),a=e(11),c=e(20),u=e(21),f=Object.prototype,p=f.hasOwnProperty;t.exports=r},function(t,n,e){function r(t){var n=i(t)?t.length:void 0;return o(n)&&c.call(t)==s}var o=e(11),i=e(15),s="[object Arguments]",a=Object.prototype,c=a.toString;t.exports=r},function(t,n,e){var r=e(11),o=e(12),i=e(15),s="[object Array]",a=Object.prototype,c=a.toString,u=o(u=Array.isArray)&&u,f=u||function(t){return i(t)&&r(t.length)&&c.call(t)==s};t.exports=f},function(t,n,e){function r(t,n){return t=+t,n=null==n?o:n,t>-1&&t%1==0&&n>t}var o=Math.pow(2,53)-1;t.exports=r},function(t,n,e){function r(t){if(null==t)return[];c(t)||(t=Object(t));var n=t.length;n=n&&a(n)&&(i(t)||u.nonEnumArgs&&o(t))&&n||0;for(var e=t.constructor,r=-1,f="function"==typeof e&&e.prototype===t,l=Array(n),h=n>0;++r<n;)l[r]=r+"";for(var d in t)h&&s(d,n)||"constructor"==d&&(f||!p.call(t,d))||l.push(d);return l}var o=e(17),i=e(18),s=e(19),a=e(11),c=e(9),u=e(21),f=Object.prototype,p=f.hasOwnProperty;t.exports=r},function(t,n,e){(function(n){var e=Object.prototype,r=(r=n.window)&&r.document,o=e.propertyIsEnumerable,i={};!function(t){i.funcDecomp=/\bthis\b/.test(function(){return this}),i.funcNames="string"==typeof Function.name;try{i.dom=11===r.createDocumentFragment().nodeType}catch(n){i.dom=!1}try{i.nonEnumArgs=!o.call(arguments,1)}catch(n){i.nonEnumArgs=!0}}(0,0),t.exports=i}).call(n,function(){return this}())},function(t,n,e){function r(t,n){return function(e,r){var s=e?e.length:0;if(!o(s))return t(e,r);for(var a=n?s:-1,c=i(e);(n?a--:++a<s)&&r(c[a],a,c)!==!1;);return e}}var o=e(11),i=e(8);t.exports=r},function(t,n,e){function r(t,n){return function(e,r,s){return"function"==typeof r&&"undefined"==typeof s&&i(e)?t(e,r):n(e,o(r,s,3))}}var o=e(24),i=e(18);t.exports=r},function(t,n,e){function r(t,n,e){if("function"!=typeof t)return o;if("undefined"==typeof n)return t;switch(e){case 1:return function(e){return t.call(n,e)};case 3:return function(e,r,o){return t.call(n,e,r,o)};case 4:return function(e,r,o,i){return t.call(n,e,r,o,i)};case 5:return function(e,r,o,i,s){return t.call(n,e,r,o,i,s)}}return function(){return t.apply(n,arguments)}}var o=e(25);t.exports=r},function(t,n,e){function r(t){return t}t.exports=r},function(t,n,e){var r=e(2),o=e(18),i=e(27),s=e(28).constants.get();t.exports=function(t,n){if(!o(t))throw new Error("createConstants expects first parameter to be an array of strings");if(n=n||"",!i(n))throw new Error("createConstants expects second parameter string");n.length>0&&(n+=s.separator);var e={};return r(t,function(t){if(!i(t))throw new Error("createConstants expects all constants to be strings");e[t]=n+t,e[t+"_"+s.successSuffix]=n+t+s.separator+s.successSuffix,e[t+"_"+s.failSuffix]=n+t+s.separator+s.failSuffix,e[t+"_"+s.afterSuffix]=n+t+s.separator+s.afterSuffix}),e}},function(t,n,e){function r(t){return"string"==typeof t||o(t)&&a.call(t)==i}var o=e(15),i="[object String]",s=Object.prototype,a=s.toString;t.exports=r},function(t,n,e){var r=e(27),o="_",i="SUCCESS",s="FAIL",a="AFTER",c={constants:{separator:o,successSuffix:i,failSuffix:s,afterSuffix:a}};t.exports={constants:{setSeparator:function(t){if(!r(t)||!t.length)throw new Error("Constants.separator must be a non empty string");c.constants.separator=t},setSuccessSuffix:function(t){if(!r(t)||!t.length)throw new Error("Constants.successSuffix must be a non empty string");c.constants.successSuffix=t},setFailSuffix:function(t){if(!r(t)||!t.length)throw new Error("Constants.failSuffix must be a non empty string");c.constants.failSuffix=t},setAfterSuffix:function(t){if(!r(t)||!t.length)throw new Error("Constants.afterSuffix must be a non empty string");c.constants.afterSuffix=t},resetToDefaults:function(){c.constants.separator=o,c.constants.successSuffix=i,c.constants.failSuffix=s,c.constants.afterSuffix=a},get:function(){return c.constants}}}},function(t,n,e){var r=e(30),o=e(2),i=e(18),s=s||e(42),a=e(28).constants.get(),c=function(t,n){this._dispatcher=t,this._registerActions(n)};c.prototype=r(c.prototype,{_registerActions:function(t){o(t,function(t,n){if(!i(t))throw new Error("ReactFlux.Actions: Action must be an array {login: [CONSTANT, callback]}");var e=t[0],r=t[1];if("undefined"==typeof r)r=function(){};else if("function"!=typeof r)throw new Error("ReactFlux.Actions: you did not provide a valid callback for action: "+n);this[n]=this._createAction(n,e,r)}.bind(this))},_createAction:function(t,n,e){return function(){this._dispatch(n,null,arguments);var t=null;try{if(t=e.apply(this,arguments),t&&"object"==typeof t&&"[object Error]"==Object.prototype.toString.call(t))throw t}catch(r){t=new s(function(t,n){n(r)})}s.resolve(t).then(function(t){this._dispatch(n,"successSuffix",t),this._dispatch(n,"afterSuffix",t)}.bind(this),function(t){this._dispatch(n,"failSuffix",t),this._dispatch(n,"afterSuffix",t)}.bind(this))["catch"](function(t){console.error(t.toString(),t.stack)})}.bind(this)},_dispatch:function(t,n,e){n&&(t+=a.separator+a[n]),this._dispatcher.dispatch(t,e)}}),t.exports=c},function(t,n,e){var r=e(31),o=e(40),i=o(r);t.exports=i},function(t,n,e){function r(t,n,e,l,h){if(!u(t))return t;var d=c(n.length)&&(a(n)||p(n));return(d?o:i)(n,function(n,o,i){if(f(n))return l||(l=[]),h||(h=[]),s(t,i,o,r,e,l,h);var a=t[o],c=e?e(a,n,o,t,i):void 0,u="undefined"==typeof c;u&&(c=n),!d&&"undefined"==typeof c||!u&&(c===c?c===a:a!==a)||(t[o]=c)}),t}var o=e(3),i=e(5),s=e(32),a=e(18),c=e(11),u=e(9),f=e(15),p=e(37);t.exports=r},function(t,n,e){function r(t,n,e,r,p,l,h){for(var d=l.length,g=n[e];d--;)if(l[d]==g)return void(t[e]=h[d]);var x=t[e],y=p?p(x,g,e,t,n):void 0,v="undefined"==typeof y;v&&(y=g,a(g.length)&&(s(g)||u(g))?y=s(x)?x:x&&x.length?o(x):[]:c(g)||i(g)?y=i(x)?f(x):c(x)?x:{}:v=!1),l.push(g),h.push(y),v?t[e]=r(y,g,p,l,h):(y===y?y!==x:x===x)&&(t[e]=y)}var o=e(33),i=e(17),s=e(18),a=e(11),c=e(34),u=e(37),f=e(38);t.exports=r},function(t,n,e){function r(t,n){var e=-1,r=t.length;for(n||(n=Array(r));++e<r;)n[e]=t[e];return n}t.exports=r},function(t,n,e){var r=e(12),o=e(35),i="[object Object]",s=Object.prototype,a=s.toString,c=r(c=Object.getPrototypeOf)&&c,u=c?function(t){if(!t||a.call(t)!=i)return!1;var n=t.valueOf,e=r(n)&&(e=c(n))&&c(e);return e?t==e||c(t)==e:o(t)}:o;t.exports=u},function(t,n,e){function r(t){var n;if(!i(t)||u.call(t)!=s||!c.call(t,"constructor")&&(n=t.constructor,"function"==typeof n&&!(n instanceof n)))return!1;var e;return o(t,function(t,n){e=n}),"undefined"==typeof e||c.call(t,e)}var o=e(36),i=e(15),s="[object Object]",a=Object.prototype,c=a.hasOwnProperty,u=a.toString;t.exports=r},function(t,n,e){function r(t,n){return o(t,n,i)}var o=e(6),i=e(20);t.exports=r},function(t,n,e){function r(t){return i(t)&&o(t.length)&&!!O[D.call(t)]}var o=e(11),i=e(15),s="[object Arguments]",a="[object Array]",c="[object Boolean]",u="[object Date]",f="[object Error]",p="[object Function]",l="[object Map]",h="[object Number]",d="[object Object]",g="[object RegExp]",x="[object Set]",y="[object String]",v="[object WeakMap]",b="[object ArrayBuffer]",S="[object Float32Array]",_="[object Float64Array]",m="[object Int8Array]",w="[object Int16Array]",j="[object Int32Array]",A="[object Uint8Array]",E="[object Uint8ClampedArray]",C="[object Uint16Array]",F="[object Uint32Array]",O={};O[S]=O[_]=O[m]=O[w]=O[j]=O[A]=O[E]=O[C]=O[F]=!0,O[s]=O[a]=O[b]=O[c]=O[u]=O[f]=O[p]=O[l]=O[h]=O[d]=O[g]=O[x]=O[y]=O[v]=!1;var I=Object.prototype,D=I.toString;t.exports=r},function(t,n,e){function r(t){return o(t,i(t))}var o=e(39),i=e(20);t.exports=r},function(t,n,e){function r(t,n,e){e||(e=n,n={});for(var r=-1,o=e.length;++r<o;){var i=e[r];n[i]=t[i]}return n}t.exports=r},function(t,n,e){function r(t){return function(){var n=arguments,e=n.length,r=n[0];if(2>e||null==r)return r;var s=n[e-2],a=n[e-1],c=n[3];e>3&&"function"==typeof s?(s=o(s,a,5),e-=2):(s=e>2&&"function"==typeof a?a:null,e-=s?1:0),c&&i(n[1],n[2],c)&&(s=3==e?null:s,e=2);for(var u=0;++u<e;){var f=n[u];f&&t(r,f,s)}return r}}var o=e(24),i=e(41);t.exports=r},function(t,n,e){function r(t,n,e){if(!s(e))return!1;var r=typeof n;if("number"==r)var a=e.length,c=i(a)&&o(n,a);else c="string"==r&&n in e;if(c){var u=e[n];return t===t?t===u:u!==u}return!1}var o=e(19),i=e(11),s=e(9);t.exports=r},function(n,e,r){n.exports=t},function(t,n,e){function r(t,n){if(null==t||"object"!=typeof t)return t;if(t.constructor!=Object&&t.constructor!=Array)return t;if(t.constructor==Date||t.constructor==RegExp||t.constructor==Function||t.constructor==String||t.constructor==Number||t.constructor==Boolean)return new t.constructor(t);n=n||new t.constructor;for(var e in t)n[e]="undefined"==typeof n[e]?r(t[e],null):n[e];return n}function o(t){var n=t;this.assign=function(t){n=i(n,t)},this.get=function(t){var e=n[t]||void 0;return e instanceof Object&&null!==e?r(e):e},this.replaceState=function(t){n=t},this.getState=function(){return r(n)}}var i=e(44),s=e(2),a=e(18),c=e(1),u="change",f=e(46),p=function(t,n,e){this.state=new o({_action_states:{}}),this._events={},this._actionHandlers={},this._constantHandlers={},this._dispatcherIndexes={},this._dispatcher=t,this._getInitialStateCalls=[],this._storeDidMountCalls=[],this._storeMixin(n),this._setInitialState(),e&&this._setConstantHandlers(e),s(this._storeDidMountCalls,function(t){t()})};p.prototype={setState:function(t){this.state.assign(t),this._emit(u)},replaceState:function(t){this.state.replaceState(t),this._emit(u)},get:function(t){return this.state.get(t)},getState:function(){return this.state.getState()},setActionState:function(t,n){var e=this.state.get("_action_states");e[t]=i(e[t]||{},n),this.setState({_action_states:e})},resetActionState:function(t){if("undefined"==typeof this._actionHandlers[t])throw new Error("Store.resetActionState constant handler for ["+t+"] is not defined");var n=this.state.get("_action_states");n[t]=this._actionHandlers[t].getInitialState(),this.setState({_action_states:n})},getActionState:function(t,n){if("undefined"==typeof this._actionHandlers[t])throw new Error("Store.getActionState constant handler for ["+t+"] is not defined");var e=this.state.get("_action_states");return"undefined"==typeof n?e[t]:e[t][n]||void 0},toJS:function(){return console.warn("toJS is deprecated. Please use store.getState instead"),this.state.getState()},toObject:function(){return console.warn("toObject is deprecated. Please use store.getState instead"),this.state.getState()},toJSON:function(){return console.warn("toJSON is deprecated. Please use store.getState instead"),this.state.getState()},isStore:function(){return!0},onChange:function(t){this._on(u,t)},offChange:function(t){this._off(u,t)},_storeMixin:function(t){t&&t.mixins&&a(t.mixins)&&s(t.mixins,this._storeMixin.bind(this)),s(t,function(t,n){"mixins"!==n&&("function"==typeof t&&(t=t.bind(this)),"getInitialState"===n?this._getInitialStateCalls.push(t):"storeDidMount"===n?this._storeDidMountCalls.push(t):this[n]=t)}.bind(this))},addActionHandler:function(t,n){return this._actionHandlers[t]=new f(this,t,n),this},_setConstantHandlers:function(t){if(!a(t))throw new Error("store expects handler definitions to be an array");s(t,function(t){if(!a(t))throw new Error("store expects handler definition to be an array");var n,e,r;if(n=t[0],2===t.length?(r=null,e=t[1]):(r=t[1],e=t[2]),"string"!=typeof n)throw new Error("store expects all handler definitions to contain a constant as the first parameter");if("function"!=typeof e)throw new Error("store expects all handler definitions to contain a callback");if(r&&!a(r))throw new Error("store expects waitFor to be an array of stores");var o=null;r&&(o=r.map(function(t){if(!(t instanceof p))throw new Error("store expects waitFor to be an array of stores");return t._getHandlerIndex(n)})),this._constantHandlers[n]=e.bind(this);var i=this._dispatcher.register(n,this._constantHandlers[n],o);this._dispatcherIndexes[n]=i}.bind(this))},_getHandlerIndex:function(t){if("undefined"==typeof this._dispatcherIndexes[t])throw new Error("Can not get store handler for constant: "+t);return this._dispatcherIndexes[t]},_setInitialState:function(){this.setState(this.getInitialState())},getInitialState:function(){var t={};return s(this._getInitialStateCalls,function(n){i(t,n())}),t},mixin:function(){return console.warn("store.mixin will be deprecated, please use store.mixinFor"),c(this)},mixinFor:function(){return c(this)},_on:function(t,n){return"undefined"==typeof this._events[t]&&(this._events[t]=[]),this._events[t].push(n),n},_off:function(t,n){if("undefined"!=typeof this._events[t])for(var e=0,r=this._events[t].length;r>e;e++)if(this._events[t][e]===n){this._events[t].splice(e,1);break}},_emit:function(t){if("undefined"!=typeof this._events[t]){var n=Array.prototype.slice.call(arguments,1);s(this._events[t],function(t){"function"==typeof t&&t.apply(null,n)})}}},t.exports=p},function(t,n,e){var r=e(45),o=e(40),i=o(r);t.exports=i},function(t,n,e){function r(t,n,e){var r=i(n);if(!e)return o(n,t,r);for(var s=-1,a=r.length;++s<a;){var c=r[s],u=t[c],f=e(u,n[c],c,t,n);(f===f?f===u:u!==u)&&("undefined"!=typeof u||c in t)||(t[c]=f)}return t}var o=e(39),i=e(10);t.exports=r},function(t,n,e){function r(t,n,e){if(!t||"function"!=typeof t.isStore||!t.isStore())throw new Error("StoreActionHandler expects first parameter to be a store");if(!o(n)||!n.length)throw new Error("StoreActionHandler expects second parameter to be a constant(string)");if("undefined"==typeof e.getInitialState&&(e.getInitialState=function(){return{}}),"function"!=typeof e.getInitialState)throw new Error("StoreActionHandler expects getInitialState to be a function");e=e||{},this.parent=t,this.constant=n,this.getInitialState=e.getInitialState,this.before=e.before||null,this.after=e.after||null,this.success=e.success||null,this.fail=e.fail||null,this.parent.setActionState(this.constant,this.getInitialState());for(var r=[],a=s.length,c=0;a>c;c++){var u=s[c];if(null!==this[u]){if("function"!=typeof this[u])throw new Error('StoreActionHandler expects "'+u+'" to be a function');var f=this.constant;"before"!==u&&(f+=i.separator+i[u+"Suffix"]),r.push([f,this[u].bind(this)])}}t._setConstantHandlers(r)}var o=e(27),i=e(28).constants.get(),s=["before","after","success","fail"];r.prototype={setState:function(t){this.parent.setActionState(this.constant,t)},getState:function(){return this.parent.getActionState(this.constant)}},t.exports=r},function(t,n,e){function r(){this._registry={}}var o=o||e(42),i=e(30),s=e(18),a=e(27),c=e(2);r.prototype=i(r.prototype,{register:function(t,n,e){if(!a(t)||!t.length)throw new Error("Dispatcher.register: constant must be a string");if(e=e||null,"function"!=typeof n)throw new Error("Dispatcher.register expects second parameter to be a callback");if(null!==e&&!s(e))throw new Error("Dispatcher.register expects third parameter to be null or an array");var r=this._getRegistry(t);return r.callbacks.push(n),r.waitFor.push(e),r.callbacks.length-1},dispatch:function(t,n){var e=this._getRegistry(t);e.dispatchQueue.push({constant:t,payload:n}),this._dispatch(e)},_dispatch:function(t){if(!t.isDispatching&&t.dispatchQueue.length){t.isDispatching=!0;var n=t.dispatchQueue.shift();this._createDispatchPromises(t),c(t.callbacks,function(e,r){var i=function(t,n,e){return function(){o.resolve(t.callbacks[n](e)).then(function(){t.resolves[n](e)},function(){t.rejects[n](new Error("Dispatch callback error"))})}}(t,r,n.payload),s=t.waitFor[r];if(s){var a=this._getPromisesByIndexes(t,s);o.all(a).then(i,i)}else i()}.bind(this)),o.all(t.promises).then(function(){this._onDispatchEnd(t)}.bind(this),function(){this._onDispatchEnd(t)})}},_getRegistry:function(t){return"undefined"==typeof this._registry[t]&&(this._registry[t]={callbacks:[],waitFor:[],promises:[],resolves:[],rejects:[],dispatchQueue:[],isDispatching:!1}),this._registry[t]},_getPromisesByIndexes:function(t,n){return n.map(function(n){return t.promises[n]})},_createDispatchPromises:function(t){t.promises=[],t.resolves=[],t.rejects=[],c(t.callbacks,function(n,e){t.promises[e]=new o(function(n,r){t.resolves[e]=n,t.rejects[e]=r})})},_onDispatchEnd:function(t){t.promises=[],t.resolves=[],t.rejects=[],t.isDispatching=!1,this._dispatch(t)}}),t.exports=r}])});